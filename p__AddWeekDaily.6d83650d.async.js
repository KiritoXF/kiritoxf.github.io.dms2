(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[326],{73798:function(ve,O,a){"use strict";a.r(O),a.d(O,{default:function(){return oe}});var ce=a(77111),z=a(49194),fe=a(13753),R=a(48429),De=a(25324),S=a(45733),ke=a(11826),P=a(8961),ge=a(42313),H=a(91991),Ee=a(14643),x=a(92909),B=a(56361),C=a(44742),Me=a(84786),T=a(52311),e=a(67294),k=a(87557),j=a(2546),J=a(87748),Q=a(56051),F=a.n(Q),X=a(52990),Ye=a(62171),$=a(63710),b=a(68699),q=a(99463),we=a(97140),_=a(90407),A=a(3911),ee=a(94043),K=a.n(ee),ae=a(60793),U=a(82721),te=function(n){var o=(0,e.useState)([]),f=(0,C.Z)(o,2),E=f[0],h=f[1],I=(0,e.useState)([]),M=(0,C.Z)(I,2),Y=M[0],N=M[1],r=(0,k.YB)(),y=r.formatMessage,t=[{title:"\u4E8B\u9879",dataIndex:"title",width:"30%",formItemProps:{rules:[{required:!0,message:"\u6B64\u9879\u4E3A\u5FC5\u586B\u9879"}]}},{title:"\u82B1\u8D39\u65F6\u95F4",dataIndex:"cost",width:"10%",renderFormItem:function(l,d,m){var c=d.type,Z=d.defaultRender,p=(0,A.Z)(d,["type","defaultRender"]);return e.createElement(P.Z,{min:0,max:24})}},{title:"\u5DE5\u4F5C\u7C7B\u522B",dataIndex:"category",width:"30%",renderFormItem:function(l,d,m){var c=d.type,Z=d.defaultRender,p=(0,A.Z)(d,["type","defaultRender"]);return e.createElement(_.Z,{options:(0,U.$6)()})}},{title:"\u64CD\u4F5C",valueType:"option",width:200,render:function(l,d,m,c){return[e.createElement("a",{key:"editable",onClick:function(){var p;(p=c.startEditable)===null||p===void 0||p.call(c,d.id)}},y({id:"cmn.edit",defaultMessage:"\u7F16\u8F91"}))]}}],s=function(l){n.dispatch({type:"addWeekDaily/saveDayInfo",payload:{week:n.week,weekData:(0,q.Z)({},n.week,{workInfos:l,ps:""})}})};return(0,e.useEffect)(function(){var u;N(((u=n.data)===null||u===void 0?void 0:u.workInfos)||[])},[]),e.createElement(e.Fragment,null,e.createElement("h3",null,y({id:"addWeekDaily.date",defaultMessage:"\u65E5\u671F:"}),n.date||y({id:"addWeekDaily.unSelected",defaultMessage:"\u672A\u9009\u62E9"})),e.createElement(ae.Z,{rowKey:"id",recordCreatorProps:{position:"end",record:{id:Math.random()*1e6,title:"",cost:0,category:""}},columns:t,request:(0,b.Z)(K().mark(function u(){var l;return K().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",{data:(n==null||(l=n.data)===null||l===void 0?void 0:l.workInfos)||[],total:3,success:!0});case 1:case"end":return m.stop()}},u)})),value:Y,onChange:function(l){N(l),s(l)},editable:{editableKeys:E,onChange:h},summary:function(l){if(!!l.length){var d=l==null?void 0:l.reduce(function(m,c){return m+(c==null?void 0:c.cost)},0);return e.createElement($.Z.Summary.Row,null,e.createElement($.Z.Summary.Cell,{index:0},y({id:"cmn.sum",defaultMessage:"\u603B\u8BA1"})),e.createElement($.Z.Summary.Cell,{index:1},d))}}}))},W=(0,k.$j)(function(v){return(0,X.Z)(v),{}})(te),We=a(50111),de=a(55419),le=a(13378),ne=a(70209),re=a(8212),ue=function(n){var o=(0,k.YB)(),f=o.formatMessage,E=(0,j.UO)(),h=(0,U.$6)(),I=h.map(function(Y){return{type:f({id:Y.label}),value:n.addWeekDaily[Y.value]}}),M={appendPadding:10,data:I,angleField:"value",colorField:"type",radius:.8,label:{type:"outer",content:"{name} {percentage}"},interactions:[{type:"pie-legend-active"},{type:"element-active"}]};return e.createElement(e.Fragment,null,E.weekNum&&e.createElement(ne.Z,(0,le.Z)({},M,{style:{height:"450px"}})),!E.weekNum&&e.createElement(de.ZP,{icon:e.createElement(re.Z,null),title:f({id:"addWeekDaily.temp",defaultMessage:"\u4FDD\u5B58\u540E\u67E5\u770B\u56FE\u8868"})}))},se=(0,k.$j)(function(v){var n=v.addWeekDaily,o=v.loading;return{addWeekDaily:n,loading:o.models.addWeekDaily}})(ue),g=T.Z.TabPane,ie=function(n){var o,f,E,h,I,M,Y,N=(0,k.YB)(),r=N.formatMessage,y=n.dispatch,t=n.dailyInfo,s=(0,j.UO)(),u=(0,e.useState)(["","","","","","",""]),l=(0,C.Z)(u,2),d=l[0],m=l[1],c=(0,e.useState)(),Z=(0,C.Z)(c,2),p=Z[0],V=Z[1],G=function(i){if(y({type:"addWeekDaily/saveDailyInfo",payload:{dailyInfo:{timeInterval:i?"".concat(i.startOf("week").format("YYYYMMDD"),"-").concat(i.startOf("week").add(6,"days").format("YYYYMMDD")):""}}}),!!i){var D=F()(i.startOf("week")),L=[D.format("YYYY-MM-DD"),D.startOf("week").add(1,"days").format("YYYY-MM-DD"),D.startOf("week").add(2,"days").format("YYYY-MM-DD"),D.startOf("week").add(3,"days").format("YYYY-MM-DD"),D.startOf("week").add(4,"days").format("YYYY-MM-DD"),D.startOf("week").add(5,"days").format("YYYY-MM-DD"),D.startOf("week").add(6,"days").format("YYYY-MM-DD")];m(L),V(i),y({type:"addWeekDaily/setSummaryDate",payload:{weekRange:L}})}},ye=function(i){y({type:"addWeekDaily/saveDailyInfo",payload:{dailyInfo:(0,B.Z)((0,B.Z)({},n.dailyInfo),{},{weekNum:i})}})};(0,e.useEffect)(function(){s.weekNum&&y({type:"addWeekDaily/getWeekDailyInfo",payload:{weekNum:Number(s.weekNum)}}).then(function(w){if(!w){alert("TODO");return}V(F()(w.payload.dailyInfo.timeInterval.split("-")[0],"YYYYMMDD")),G(F()(w.payload.dailyInfo.timeInterval.split("-")[0],"YYYYMMDD"))})},[s.weekNum]),(0,e.useEffect)(function(){return function(){y({type:"addWeekDaily/clearState"})}},[k.m8.pathname]);var me=function(){return y({type:"addWeekDaily/saveWeekDaily",payload:{dailyInfo:t,updateFlg:!!s.weekNum}}).then(function(i){var D=i.status;D===400?x.default.error({key:"saveWeekDailyDuplicate",duration:2,content:r({id:"addWeekDaily.duplicate",defaultMessage:"\u5DF2\u7ECF\u5B58\u5728\u5468\u62A5".concat(t.weekNum,"\uFF0C\u8BF7\u68C0\u67E5")},{weekNum:s.weekNum})}):(x.default.success({key:"saveWeekDailySuccess",duration:2,content:s.weekNum?r({id:"addWeekDaily.updateSuccess",defaultMessage:"\u66F4\u65B0\u5468\u62A5".concat(s.weekNum,"\u6210\u529F")},{weekNum:s.weekNum}):r({id:"addWeekDaily.createSuccess",defaultMessage:"\u65B0\u589E\u5468\u62A5".concat(t.weekNum,"\u6210\u529F")},{weekNum:s.weekNum})}),k.m8.push("/weekDaily"))})};return e.createElement(e.Fragment,null,e.createElement(S.Z,{direction:"vertical",style:{width:"100%"}},e.createElement(S.Z,null,e.createElement("span",null,r({id:"addWeekDaily.selectWeekRange",defaultMessage:"\u9009\u62E9\u672C\u5468"})),e.createElement(H.Z,{picker:"week",format:"YYYY-MM-DD(wo)",value:p,onChange:G}),e.createElement("span",null,r({id:"addWeekDaily.selectWeekNum",defaultMessage:"\u9009\u62E9\u5468\u6570"})),e.createElement(P.Z,{min:1,defaultValue:Number(s.weekNum)||1,onChange:function(i){return ye(i)}})),d[0]!==""&&e.createElement(S.Z,null,e.createElement("span",null,r({id:"addWeekDaily.weekRange",defaultMessage:"\u672C\u5468\u8D77\u6B62\u65F6\u95F4"})),e.createElement("span",null,d[0],"~",d[6])),e.createElement(S.Z,null,e.createElement(R.Z,{type:"primary",onClick:function(){return me()}},r({id:"cmn.save",defaultMessage:"\u4FDD\u5B58"})),e.createElement(J.rU,{to:"/weekDaily"},e.createElement(R.Z,null,r({id:"cmn.back",defaultMessage:"\u8FD4\u56DE"})))),e.createElement(z.Z,null),e.createElement(T.Z,{centered:!0,type:"card"},e.createElement(g,{tab:r({id:"addWeekDaily.detail",defaultMessage:"\u8BE6\u60C5"}),key:"0"},e.createElement(se,null)),e.createElement(g,{tab:r({id:"addWeekDaily.monday",defaultMessage:"\u5468\u4E00"}),key:"1"},e.createElement(W,{data:t==null||(o=t.weekData)===null||o===void 0?void 0:o.monday,date:d[0],week:"monday"})),e.createElement(g,{tab:r({id:"addWeekDaily.tuesday",defaultMessage:"\u5468\u4E8C"}),key:"2"},e.createElement(W,{data:t==null||(f=t.weekData)===null||f===void 0?void 0:f.tuesday,date:d[1],week:"tuesday"})),e.createElement(g,{tab:r({id:"addWeekDaily.wednesday",defaultMessage:"\u5468\u4E09"}),key:"3"},e.createElement(W,{data:t==null||(E=t.weekData)===null||E===void 0?void 0:E.wednesday,date:d[2],week:"wednesday"})),e.createElement(g,{tab:r({id:"addWeekDaily.thursday",defaultMessage:"\u5468\u56DB"}),key:"4"},e.createElement(W,{data:t==null||(h=t.weekData)===null||h===void 0?void 0:h.thursday,date:d[3],week:"thursday"})),e.createElement(g,{tab:r({id:"addWeekDaily.friday",defaultMessage:"\u5468\u4E94"}),key:"5"},e.createElement(W,{data:t==null||(I=t.weekData)===null||I===void 0?void 0:I.friday,date:d[4],week:"friday"})),e.createElement(g,{tab:r({id:"addWeekDaily.saturday",defaultMessage:"\u5468\u516D"}),key:"6"},e.createElement(W,{data:t==null||(M=t.weekData)===null||M===void 0?void 0:M.saturday,date:d[5],week:"saturday"})),e.createElement(g,{tab:r({id:"addWeekDaily.sunday",defaultMessage:"\u5468\u65E5"}),key:"7"},e.createElement(W,{data:t==null||(Y=t.weekData)===null||Y===void 0?void 0:Y.sunday,date:d[6],week:"sunday"})))))},oe=(0,k.$j)(function(v){var n=v.addWeekDaily,o=v.loading;return{dailyInfo:n,loading:o.models.weekDaily}})(ie)}}]);
